import{_ as k,o as r,c as b,a as t,t as c,i as C,l as U,x as L,h as R,F as S,p as j,e as I}from"./index-CN0wElha.js";const P={props:["bentoTemp","generateBento","memberData"],data(){return{apiUrl:"https://whatstoday2024-8nsu.onrender.com",mealType:"午餐",bentoDate:"",bentoRecords:[],path:""}},methods:{async getBentoRecords(){await this.axios.get(`${this.apiUrl}/600/users/${this.memberData.id}/records/`).then(d=>{this.bentoRecords=d.data.message})},async saveToDiary(){await this.getBentoRecords();let d=new Date().toISOString().slice(0,10);const o={...this.bentoTemp,date:this.bentoDate?this.bentoDate:d,mealType:this.mealType},e=this.bentoRecords.find(i=>i.date===o.date&&i.mealType===o.mealType);e?confirm("該時段已有便當紀錄，請問是否決定覆蓋該紀錄？")&&await this.axios.patch(`${this.apiUrl}/600/records/${e.id}`,o).then(l=>{console.log("done-patch",l.data.message)}):await this.axios.post(`${this.apiUrl}/600/users/${this.memberData.id}/records/`,o).then(i=>{console.log("done-post",i.data.message)})},async deleteRecord(){await this.axios.delete(`${this.apiUrl}/600/records/${this.bentoTemp.idTemp}`).then(()=>{location.reload()})}},mounted(){this.path=this.$route.path}},s=d=>(j("data-v-b3d560e7"),d=d(),I(),d),V={class:"modal fade",id:"bentoModal",tabindex:"-1","aria-labelledby":"bentoModalLabel","aria-hidden":"true"},F={class:"modal-dialog modal-lg modal-dialog-centered"},N={class:"modal-content bento"},z=s(()=>t("div",{class:"modal-header px-4"},[t("h3",{class:"modal-title",id:"bentoModalLabel"},"今天吃什麼？"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),E={class:"modal-body row m-0 row-cols-1 row-cols-lg-2"},O={class:"bento-description col-lg-4 order-last order-lg-1 row m-0 p-lg-3"},q={class:"nutrition-portion p-3 col-6 col-lg-12"},A=s(()=>t("h4",{class:"mb-3 lh-base"},"營養比例：",-1)),G={class:"row row-cols-1"},H={class:"col row row-cols-2"},J=s(()=>t("div",{class:"col"},[t("p",{class:"m-0"},"澱粉")],-1)),K={class:"col"},Q={class:"m-0 text-end"},W={class:"col row row-cols-2"},X=s(()=>t("div",{class:"col"},[t("p",{class:"m-0"},"蛋白質")],-1)),Y={class:"col"},Z={class:"m-0 text-end"},$={class:"col row row-cols-2"},tt=s(()=>t("div",{class:"col"},[t("p",{class:"m-0"},"蔬菜")],-1)),et={class:"col"},ot={class:"m-0 text-end"},st={key:0,class:"btns text-center p-3 col-6 col-lg-12"},at=s(()=>t("button",{class:"btn btn-outline-primary re-generate-btn px-4 py-3 m-2","data-bs-toggle":"modal","data-bs-target":"#confirmRegenerateBentoModal",title:"重新生成便當"},"重新生成便當",-1)),lt=["title","disabled"],dt={key:1,class:"btns text-center p-3 col-6 col-lg-12"},it=s(()=>t("button",{class:"btn btn-outline-primary re-generate-btn px-4 py-3 m-2","data-bs-toggle":"modal","data-bs-target":"#confirmDeleteRecordModal",title:"刪除此便當紀錄"},"刪除此便當紀錄",-1)),nt={class:"bento-presentation col-lg-8 order-first order-lg-2"},ct={class:"border border-gray border-3 rounded w-100 h-100 p-3 pb-4"},rt={class:"row g-2 h-100"},bt={class:"col col-4 h-50"},mt={class:"side-dish border border-gray border-3 rounded h-100"},ht=["src","alt","title"],_t={class:"col col-4 h-50"},gt={class:"side-dish border border-gray border-3 rounded h-100"},ut=["src","alt","title"],pt={class:"col col-4 h-50"},vt={class:"side-dish border border-gray border-3 rounded h-100"},yt=["src","alt","title"],Tt={class:"col col-12 h-50"},ft={class:"border border-gray border-3 rounded col-12 h-100 p-0 d-flex"},Dt={class:"staple w-50"},wt=["src","alt","title"],xt={class:"entree w-50"},Mt=["src","alt","title"],Bt={class:"modal fade",id:"confirmRegenerateBentoModal",tabindex:"-1","aria-labelledby":"confirmRegenerateBentoModalLabel","aria-hidden":"true"},Ct={class:"modal-dialog modal-dialog-centered"},Rt={class:"modal-content"},kt=s(()=>t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"confirmRegenerateBentoModalLabel"},"是否確認重新生成新的便當？"),t("button",{type:"button",class:"btn-close","aria-label":"Close","data-bs-toggle":"modal","data-bs-target":"#bentoModal"})],-1)),Ut=s(()=>t("div",{class:"modal-body"}," 此操作將無法復原，請確認是否執行。 ",-1)),Lt={class:"modal-footer"},St=s(()=>t("button",{type:"button",class:"btn btn-secondary","data-bs-toggle":"modal","data-bs-target":"#bentoModal"},"取消",-1)),jt={class:"modal fade",id:"saveToBentoDiaryModal",tabindex:"-1","aria-labelledby":"saveToBentoDiaryModalLabel","aria-hidden":"true"},It={class:"modal-dialog modal-dialog-centered"},Pt={class:"modal-content"},Vt=s(()=>t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"saveToBentoDiaryModalLabel"},"存至便當日記"),t("button",{type:"button",class:"btn-close","data-bs-toggle":"modal","data-bs-target":"#bentoModal","aria-label":"Close"})],-1)),Ft={class:"modal-body"},Nt={class:"mb-3"},zt=s(()=>t("label",{class:"mx-2",for:"bentoDate"},"便當日記：",-1)),Et=s(()=>t("label",{class:"mx-2",for:"bentoDate"},"這是我的：",-1)),Ot={class:"btn-group",role:"group","aria-label":"Basic outlined example"},qt={class:"modal-footer"},At={class:"modal fade",id:"confirmDeleteRecordModal",tabindex:"-1","aria-labelledby":"confirmDeleteRecordModalLabel","aria-hidden":"true"},Gt={class:"modal-dialog modal-dialog-centered"},Ht={class:"modal-content"},Jt=s(()=>t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"confirmDeleteRecordModalLabel"},"是否確認刪除此便當紀錄？"),t("button",{type:"button",class:"btn-close","aria-label":"Close","data-bs-toggle":"modal","data-bs-target":"#bentoModal"})],-1)),Kt=s(()=>t("div",{class:"modal-body"}," 此操作將無法復原，請確認是否執行。 ",-1)),Qt={class:"modal-footer"},Wt=s(()=>t("button",{type:"button",class:"btn btn-secondary","data-bs-toggle":"modal","data-bs-target":"#bentoModal"},"取消",-1));function Xt(d,o,e,i,l,n){var m,h,_,g,u,p,v,y,T,f,D,w,x,M,B;return r(),b(S,null,[t("div",V,[t("div",F,[t("div",N,[z,t("div",E,[t("div",O,[t("div",q,[A,t("div",G,[t("div",H,[J,t("div",K,[t("p",Q,c(Math.round(e.bentoTemp.starchTotalPortion/4*100)/100)+" 碗",1)])]),t("div",W,[X,t("div",Y,[t("p",Z,c(e.bentoTemp.proteinTotalPortion)+" 份",1)])]),t("div",$,[tt,t("div",et,[t("p",ot,c(e.bentoTemp.vegetableTotalPortion)+" 份",1)])])])]),l.path==="/menu"?(r(),b("div",st,[at,t("button",{class:"btn btn-primary save-to-diary-btn px-4 py-3 m-2","data-bs-toggle":"modal","data-bs-target":"#saveToBentoDiaryModal",title:e.memberData.id?"存至便當日記":"便當日記為會員限定功能",disabled:!e.memberData.id},"存至便當日記",8,lt)])):C("",!0),l.path==="/member/bento-diary"?(r(),b("div",dt,[t("p",null,c(e.bentoTemp.dateTemp),1),t("p",null,c(e.bentoTemp.mealType),1),it])):C("",!0)]),t("div",nt,[t("div",ct,[t("div",rt,[t("div",bt,[t("div",mt,[t("img",{class:"img rounded object-fit-cover h-100",src:(m=e.bentoTemp.sideDishes[0])==null?void 0:m.imgUrl,alt:((h=e.bentoTemp.sideDishes[0])==null?void 0:h.title)+"的圖片",title:(_=e.bentoTemp.sideDishes[0])==null?void 0:_.title},null,8,ht)])]),t("div",_t,[t("div",gt,[t("img",{class:"img rounded object-fit-cover h-100",src:(g=e.bentoTemp.sideDishes[1])==null?void 0:g.imgUrl,alt:((u=e.bentoTemp.sideDishes[1])==null?void 0:u.title)+"的圖片",title:(p=e.bentoTemp.sideDishes[1])==null?void 0:p.title},null,8,ut)])]),t("div",pt,[t("div",vt,[t("img",{class:"img rounded object-fit-cover h-100",src:(v=e.bentoTemp.sideDishes[2])==null?void 0:v.imgUrl,alt:((y=e.bentoTemp.sideDishes[2])==null?void 0:y.title)+"的圖片",title:(T=e.bentoTemp.sideDishes[2])==null?void 0:T.title},null,8,yt)])]),t("div",Tt,[t("div",ft,[t("div",Dt,[t("img",{class:"img img-fluid object-fit-cover h-100",src:(f=e.bentoTemp.stapleCourse)==null?void 0:f.imgUrl,alt:((D=e.bentoTemp.stapleCourse)==null?void 0:D.title)+"的圖片",title:(w=e.bentoTemp.stapleCourse)==null?void 0:w.title},null,8,wt)]),t("div",xt,[t("img",{class:"img img-fluid object-fit-cover h-100",src:(x=e.bentoTemp.mainCourse)==null?void 0:x.imgUrl,alt:((M=e.bentoTemp.mainCourse)==null?void 0:M.title)+"的圖片",title:(B=e.bentoTemp.mainCourse)==null?void 0:B.title},null,8,Mt)])])])])])])])])])]),t("div",Bt,[t("div",Ct,[t("div",Rt,[kt,Ut,t("div",Lt,[St,t("button",{type:"button",class:"btn btn-primary",onClick:o[0]||(o[0]=(...a)=>e.generateBento&&e.generateBento(...a)),"data-bs-toggle":"modal","data-bs-target":"#bentoModal"},"確認")])])])]),t("div",jt,[t("div",It,[t("div",Pt,[Vt,t("div",Ft,[t("div",Nt,[zt,U(t("input",{class:"form-control me-4 w-auto d-inline-block",id:"bentoDate",type:"date","onUpdate:modelValue":o[1]||(o[1]=a=>l.bentoDate=a)},null,512),[[L,l.bentoDate]])]),t("div",null,[Et,t("div",Ot,[t("button",{type:"button",class:R(["lunch-btn btn btn-outline-primary px-2 py-1",{active:l.mealType==="午餐"}]),onClick:o[2]||(o[2]=a=>l.mealType="午餐")},"午餐",2),t("button",{type:"button",class:R(["dinner-btn btn btn-outline-primary px-2 py-1",{active:l.mealType==="晚餐"}]),onClick:o[3]||(o[3]=a=>l.mealType="晚餐")},"晚餐",2)])])]),t("div",qt,[t("button",{type:"button",class:"btn btn-secondary","data-bs-toggle":"modal","data-bs-target":"#bentoModal",onClick:o[4]||(o[4]=(...a)=>n.getBentoRecords&&n.getBentoRecords(...a))},"取消"),t("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:o[5]||(o[5]=(...a)=>n.saveToDiary&&n.saveToDiary(...a))},"確認儲存")])])])]),t("div",At,[t("div",Gt,[t("div",Ht,[Jt,Kt,t("div",Qt,[Wt,t("button",{type:"button",class:"btn btn-primary",onClick:o[6]||(o[6]=(...a)=>n.deleteRecord&&n.deleteRecord(...a)),"data-bs-dismiss":"modal"},"確認")])])])])],64)}const Zt=k(P,[["render",Xt],["__scopeId","data-v-b3d560e7"]]);export{Zt as B};
