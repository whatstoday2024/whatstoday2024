import{_ as S,o as i,c as n,a as e,b as g,f as x,t as h,u as T,r as w,j as v,F as m,h as C,l as u,v as f,g as p,i as D,x as F,p as M,e as V}from"./index-CovEMED6.js";import{M as W}from"./modal-Cnnn2l5f.js";import{w as I}from"./index-ROnsvRMF.js";import{_ as O}from"./index-DjcJslyN.js";const R={data(){return{modal:{},message:""}},components:{Warning:I},methods:{show(l){this.message=l,this.modal.show()},sendRemove(){this.$emit("removeItem"),this.modal.hide()}},mounted(){this.modal=new W(this.$refs.modal)}},U={class:"modal fade",ref:"modal"},L={class:"modal-dialog h-100 d-flex align-items-center my-0"},N={class:"modal-content"},B={class:"modal-body text-center"},P={class:"lh-base mb-1"},Y=e("span",{class:"d-block d-sm-inline"},"確定要移除",-1),j=e("p",{class:"mb-0 text-muted"},"移除後不能復原，請務必確認！",-1),z={class:"modal-footer justify-content-center border-0 pb-3"};function A(l,s,c,a,t,r){const b=w("Warning");return i(),n("div",U,[e("div",L,[e("div",N,[e("div",B,[g(b,{class:"my-3",style:{width:"150px",height:"150px",color:"#fde4b4"}}),e("h5",P,[Y,x(h(`「 ${t.message} 」的放縱日嗎？`),1)]),j]),e("div",z,[e("a",{href:"#",class:"link-secondary",onClick:s[0]||(s[0]=T(_=>t.modal.hide(),["prevent"]))},"取消"),e("button",{type:"button",class:"btn btn-danger",onClick:s[1]||(s[1]=(..._)=>r.sendRemove&&r.sendRemove(..._))},"刪除")])])])],512)}const E=S(R,[["render",A]]);document.title="放縱一下";const q={data(){return{isLoading:!1,isSpecificDay:!1,template:{weekTitle:["一","二","三","四","五","六","日"],day:30},freeDays:{},select:{weekly:"",monthly:"",yearly:{month:"",day:""},specific:""},deleteTemp:{}}},emits:["updateProfile"],components:{DeleteModal:E},mixins:[O],methods:{updateFreeDaysData(l){this.isLoading=!0;const s={};s[l]=this.freeDays[l],this.axios.patch(`https://whatstoday2024-8nsu.onrender.com/600/freeDays/${this.freeDays.id}`,s,{headers:{authorization:this.$cookie.getMemberToken()}}).then(()=>{v.success("放縱日已更新"),this.getFreeDaysData()}).catch(c=>{var a;v.error(((a=c.data)==null?void 0:a.message)||c)})},setTemplateDay(l){this.select.yearly.day="",this.template.day=new Date(2024,l,0).getDate()},setStringFormat(l){return l<10?`0${l}`:l},addWeekly(l){this.freeDays.weekly.indexOf(l)<0?(this.freeDays.weekly.push(l),this.freeDays.weekly.sort((c,a)=>c-a),this.updateFreeDaysData("weekly")):this.showWarningToast(`每週${this.template.weekTitle[l]}`),this.select.weekly=""},addMonthly(l){this.freeDays.monthly.indexOf(l)<0?(this.freeDays.monthly.push(l),this.freeDays.monthly.sort((c,a)=>c-a),this.updateFreeDaysData("monthly")):this.showWarningToast(`每月${l}號`),this.select.monthly=""},addYearly({month:l,day:s}){const c=`${this.setStringFormat(l)}/${this.setStringFormat(s)}`;this.freeDays.yearly.indexOf(c)<0?(this.freeDays.yearly.push(c),this.freeDays.yearly.sort(),this.updateFreeDaysData("yearly")):this.showWarningToast(c),this.select.yearly.month="",this.select.yearly.day=""},addSpecificDay(l){l=l.replaceAll("-","/"),this.freeDays.specific.indexOf(l)<0?(this.freeDays.specific.push(l),this.freeDays.specific.sort(),this.updateFreeDaysData("specific")):this.showWarningToast(l),this.select.specific=""},showWarningToast(l){v.warn(`「${l}」放縱日已設定過`,{autoClose:3e3})},removeConfirm(l,s){this.deleteTemp={mode:l,day:s};let c="";switch(l){case"weekly":{c=`每週${this.template.weekTitle[s]}`;break}case"monthly":{c=`每月${s}號`;break}case"yearly":{const a=s.split("/");c=`每年${a[0]}月${a[1]}日`;break}case"specific":{const a=s.split("/");c=`${a[0]}年${a[1]}月${a[2]}日`;break}}this.$refs.DeleteModal.show(c)},removeFreeDays(){const{mode:l,day:s}=this.deleteTemp,c=this.freeDays[l].indexOf(s);c>-1&&(this.freeDays[l].splice(c,1),this.updateFreeDaysData(l))}},mounted(){this.getFreeDaysData()}},y=l=>(M("data-v-7e789335"),l=l(),V(),l),G={class:"container flex-fill d-flex flex-column pb-5"},H=y(()=>e("h2",{class:"text-center my-3"},"我的放縱日",-1)),J={class:"btn-group"},K=["checked"],Q=["checked"],X={class:"border border-primary border-top-0 rounded-bottom p-4 pt-5 flex-fill",style:{transform:"translateY(-5px)"}},Z={class:"row g-1"},$=y(()=>e("div",{class:"col-auto"},[e("h5",{class:"mb-0 mt-2 me-4"},"每週：")],-1)),ee={class:"col-12 col-md"},te={class:"my-2 my-md-0"},se=["disabled"],oe=y(()=>e("option",{value:"",selected:"",disabled:""},"請選擇星期",-1)),le=["value"],ie=["disabled"],ne={key:0,class:"my-2"},ce=["onClick"],ae=y(()=>e("i",{class:"bi bi-x me-1"},null,-1)),re={key:1,class:"text-muted my-2"},de={class:"row mt-4 g-1"},me=y(()=>e("div",{class:"col-auto"},[e("h5",{class:"mb-0 mt-2 me-4"},"每月：")],-1)),ye={class:"col-12 col-md"},he={class:"my-2 my-md-0"},pe=["disabled"],ue=y(()=>e("option",{value:"",selected:"",disabled:""},"請選擇日期",-1)),_e=["value"],fe=["disabled"],be={key:0,class:"my-2"},ke=["onClick"],ve=y(()=>e("i",{class:"bi bi-x me-1"},null,-1)),De={key:1,class:"text-muted my-2"},ge={class:"row mt-4 g-1"},xe=y(()=>e("div",{class:"col-auto"},[e("h5",{class:"mb-0 mt-3 me-4"},"每年：")],-1)),we={class:"col-12 col-md"},Ce=y(()=>e("option",{value:"",selected:"",disabled:""},"請選擇月份",-1)),Se=["value"],Te=["disabled"],Fe=y(()=>e("option",{value:"",selected:"",disabled:""},"請選擇日期",-1)),Me=["value"],Ve=["disabled"],We={key:0,class:"text-muted"},Ie={key:0,class:"list-group border overflow-y-auto mt-2",style:{"max-height":"250px"}},Oe={class:"d-flex align-items-center"},Re={class:"mb-0"},Ue={class:"mb-0 mx-2 flex-fill text-center"},Le=["onClick"],Ne=y(()=>e("i",{class:"bi bi-x-lg"},null,-1)),Be=[Ne],Pe=["disabled"],Ye={key:0,class:"list-group border overflow-y-auto mt-3",style:{"max-height":"250px"}},je={class:"d-flex align-items-center"},ze={class:"mb-0"},Ae={class:"mb-0 mx-2 flex-fill text-center"},Ee=["onClick"],qe=y(()=>e("i",{class:"bi bi-x-lg"},null,-1)),Ge=[qe],He={key:1,class:"text-muted mt-2 ms-1"};function Je(l,s,c,a,t,r){const b=w("loadingVue"),_=w("DeleteModal");return i(),n(m,null,[g(b,{active:t.isLoading},null,8,["active"]),g(_,{ref:"DeleteModal",onRemoveItem:r.removeFreeDays},null,8,["onRemoveItem"]),e("div",G,[H,t.freeDays.weekly?(i(),n(m,{key:0},[e("div",J,[e("input",{type:"radio",class:"btn-check",id:"btn-check",name:"mode",onClick:s[0]||(s[0]=o=>t.isSpecificDay=!1),checked:!t.isSpecificDay},null,8,K),e("label",{class:C(["btn btn-lg btn-outline-primary",{"text-white":!t.isSpecificDay}]),for:"btn-check"},"週期放縱",2),e("input",{type:"radio",class:"btn-check",id:"btn-check-2",name:"mode",onClick:s[1]||(s[1]=o=>t.isSpecificDay=!0),checked:t.isSpecificDay},null,8,Q),e("label",{class:C(["btn btn-lg btn-outline-primary",{"text-white":t.isSpecificDay}]),for:"btn-check-2"},"特定放縱",2)]),e("div",X,[t.isSpecificDay?(i(),n(m,{key:1},[e("div",null,[u(e("input",{type:"date",class:"form-control me-4 w-auto d-inline-block","onUpdate:modelValue":s[10]||(s[10]=o=>t.select.specific=o)},null,512),[[F,t.select.specific]]),e("button",{type:"button",class:"btn btn-primary mb-1",disabled:t.select.specific==="",onClick:s[11]||(s[11]=o=>r.addSpecificDay(t.select.specific))},"新增",8,Pe)]),t.freeDays.specific.length?(i(),n("ul",Ye,[(i(!0),n(m,null,p(t.freeDays.specific,(o,d)=>(i(),n("li",{class:"list-group-item",key:"year"+d},[e("div",je,[e("p",ze,h(`${d+1}.`),1),e("p",Ae,h(o),1),e("button",{type:"button",class:"btn border-0 stretched-link",onClick:k=>r.removeConfirm("specific",o)},Ge,8,Ee)])]))),128))])):(i(),n("p",He,"無設定特定日期的放縱日"))],64)):(i(),n(m,{key:0},[e("div",Z,[$,e("div",ee,[e("div",te,[u(e("select",{class:"form-select form-select me-4 w-auto d-inline-block","onUpdate:modelValue":s[2]||(s[2]=o=>t.select.weekly=o),disabled:t.freeDays.weekly.length>=7},[oe,(i(!0),n(m,null,p(t.template.weekTitle,(o,d)=>(i(),n("option",{value:d,key:"weekly"+d},h(o),9,le))),128))],8,se),[[f,t.select.weekly]]),e("button",{type:"button",class:"btn btn-primary mb-1",disabled:t.select.weekly==="",onClick:s[3]||(s[3]=o=>r.addWeekly(t.select.weekly))},"新增",8,ie)]),t.freeDays.weekly.length?(i(),n("p",ne,[(i(!0),n(m,null,p(t.freeDays.weekly,(o,d)=>(i(),n("button",{key:"day"+d,type:"button",class:"btn btn-outline-secondary me-2 mb-2 pe-3",onClick:k=>r.removeConfirm("weekly",o)},[ae,x(h(`每週${t.template.weekTitle[o]}`),1)],8,ce))),128))])):(i(),n("p",re,"無設定每週的放縱日"))])]),e("div",de,[me,e("div",ye,[e("div",he,[u(e("select",{class:"form-select form-select me-4 w-auto d-inline-block","onUpdate:modelValue":s[4]||(s[4]=o=>t.select.monthly=o),disabled:t.freeDays.monthly.length>=31},[ue,(i(),n(m,null,p(31,o=>e("option",{value:o,key:"day"+o},h(`${o}號`),9,_e)),64))],8,pe),[[f,t.select.monthly]]),e("button",{type:"button",class:"btn btn-primary mb-1",disabled:t.select.monthly==="",onClick:s[5]||(s[5]=o=>r.addMonthly(t.select.monthly))},"新增",8,fe)]),t.freeDays.monthly.length?(i(),n("p",be,[(i(!0),n(m,null,p(t.freeDays.monthly,(o,d)=>(i(),n("button",{key:"day"+d,type:"button",class:"btn btn-outline-secondary me-2 mb-2 pe-3",onClick:k=>r.removeConfirm("monthly",o)},[ve,x(h(`每月${o}號`),1)],8,ke))),128))])):(i(),n("p",De,"無設定每月的放縱日"))])]),e("div",ge,[xe,e("div",we,[u(e("select",{class:"form-select form-select me-4 w-auto d-inline-block","onUpdate:modelValue":s[6]||(s[6]=o=>t.select.yearly.month=o),onChange:s[7]||(s[7]=o=>r.setTemplateDay(t.select.yearly.month))},[Ce,(i(),n(m,null,p(12,o=>e("option",{value:o,key:"day"+o},h(`${o}月`),9,Se)),64))],544),[[f,t.select.yearly.month]]),u(e("select",{class:"form-select form-select my-2 me-4 w-auto d-inline-block","onUpdate:modelValue":s[8]||(s[8]=o=>t.select.yearly.day=o),disabled:t.select.yearly.month===""},[Fe,(i(!0),n(m,null,p(t.template.day,o=>(i(),n("option",{value:o,key:"day"+o},h(`${o}號`),9,Me))),128))],8,Te),[[f,t.select.yearly.day]]),e("button",{type:"button",class:"btn btn-primary mb-1",disabled:t.select.yearly.month===""||t.select.yearly.day==="",onClick:s[9]||(s[9]=o=>r.addYearly(t.select.yearly))},"新增",8,Ve),t.freeDays.yearly.length?D("",!0):(i(),n("p",We,"無設定每年的放縱日"))])]),t.freeDays.yearly.length?(i(),n("ul",Ie,[(i(!0),n(m,null,p(t.freeDays.yearly,(o,d)=>(i(),n("li",{class:"list-group-item",key:"year"+d},[e("div",Oe,[e("p",Re,h(`${d+1}.`),1),e("p",Ue,h(o),1),e("button",{type:"button",class:"btn border-0 stretched-link",onClick:k=>r.removeConfirm("yearly",o)},Be,8,Le)])]))),128))])):D("",!0)],64))])],64)):D("",!0)])],64)}const $e=S(q,[["render",Je],["__scopeId","data-v-7e789335"]]);export{$e as default};
