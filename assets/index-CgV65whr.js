import{m as d}from"./memberData-B3nG-T8E.js";import{_ as u,m as h,c as l,d as m,k as p,j as f,F as g,e as i,o as r}from"./index-4BPesMZs.js";const _={data(){return{isRouterAlive:!0,isLoading:!1}},methods:{checkAuth(){const e=this.$cookie.getMemberToken(),t=this.$cookie.getMemberId();if(!e||!t){this.redirect();return}this.isLoading=!0,this.axios.defaults.headers.common.Authorization=`Bearer ${e}`,this.axios.get(`https://whatstoday2024.onrender.com/600/users/${t}`).then(o=>{this.setMemberData(o.data.message),this.isLoading=!1}).catch(()=>{this.redirect()})},redirect(){this.isLoading=!1,alert("請先登入"),this.$router.replace({name:"Login"})},async updateProfile(){this.isRouterAlive=!1,await this.checkAuth(),this.isRouterAlive=!0},...h(d,["setMemberData"])},created(){this.checkAuth()}};function k(e,t,o,A,s,a){const n=i("loadingVue"),c=i("RouterView");return r(),l(g,null,[m(n,{active:s.isLoading},null,8,["active"]),s.isRouterAlive?(r(),p(c,{key:0,onUpdateProfile:a.updateProfile},null,8,["onUpdateProfile"])):f("",!0)],64)}const x=u(_,[["render",k]]);export{x as default};
