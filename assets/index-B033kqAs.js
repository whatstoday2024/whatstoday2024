import{_ as V,s as x,B as p,m as k,c as h,b as a,a as e,w as y,F as M,k as _,r,o as g,f as F,t as f,i as S,h as b}from"./index-CzXxoeaI.js";const D={data(){return{user:{email:"",password:""},errorMsg:"",isLoading:!1}},watch:{"user.email":function(){this.errorMsg=""},"user.password":function(){this.errorMsg=""}},computed:{...x(_,["memberData"])},methods:{login(){document.title="後台登入",this.isLoading=!0,p.post("https://vue3-course-api.hexschool.io/v2/admin/signin",{username:this.user.email,password:this.user.password}).then(o=>{const t=o.data.token,l=o.data.expired;document.cookie=`token=${t}`,document.cookie=`expDate=${l}`,p.post("https://whatstoday2024-8nsu.onrender.com/login",this.user).then(d=>{const{accessToken:s,user:n}=d.data;document.cookie=`whatstoday=${s}`,document.cookie=`whatstodayMember=${n.id}`,this.setMemberData(n),this.$router.push("/admin/dashboard")}).catch(()=>{this.errorMsg="登入失敗"})}).catch(o=>{this.errorMsg=o.response.data.message}).finally(()=>{this.isLoading=!1})},...k(_,["setMemberData"])},async mounted(){}},B={class:"container flex-fill py-4 py-lg-5 d-flex align-items-center"},C={class:"w-100"},L={class:"row g-3 g-lg-4 justify-content-evenly"},N={class:"col-lg-6"},E=e("h1",{class:"h2 mb-3 text-center"},"後台登入(僅供管理者)",-1),$={key:0,class:"text-center text-danger"},q={class:"form-floating mb-4"},T=e("label",{for:"email"},"請輸入電子信箱",-1),U={class:"form-floating mb-4"},j=e("label",{for:"password"},"請輸入密碼",-1),z=e("button",{type:"submit",class:"btn btn-brand-blue btn-lg rounded-pill mb-4"},"登入",-1);function A(o,t,l,d,s,n){const w=r("loadingVue"),c=r("VField"),m=r("ErrorMessage"),v=r("VForm");return g(),h(M,null,[a(w,{active:s.isLoading},null,8,["active"]),e("div",B,[e("div",C,[e("div",L,[e("div",N,[a(v,{class:"card rounded-4 p-4 p-lg-5",onSubmit:n.login},{default:y(({errors:u})=>[E,F(" "+f(o.memberStore)+" ",1),s.errorMsg?(g(),h("h4",$,f(s.errorMsg),1)):S("",!0),e("div",q,[a(c,{type:"email",id:"email",placeholder:"請輸入電子信箱",name:"信箱",class:b(["form-control",{"is-invalid":u.信箱}]),rules:"email|required",modelValue:s.user.email,"onUpdate:modelValue":t[0]||(t[0]=i=>s.user.email=i)},null,8,["class","modelValue"]),a(m,{name:"信箱",class:"invalid-feedback"}),T]),e("div",U,[a(c,{type:"password",id:"password",placeholder:"請輸入密碼",name:"密碼",class:b(["form-control",{"is-invalid":u.密碼}]),rules:"required",modelValue:s.user.password,"onUpdate:modelValue":t[1]||(t[1]=i=>s.user.password=i)},null,8,["class","modelValue"]),a(m,{name:"密碼",class:"invalid-feedback"}),j]),z]),_:1},8,["onSubmit"])])])])])],64)}const H=V(D,[["render",A]]);export{H as default};
